<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.mapper.CartMapper">
   	<!-- 장바구니 목록 -->
    <select id="plist" resultType="hashmap">
        select pack.*, p.*, pack.package_cart_quantity*p.photo_package_price totprice
		from package_cart pack, photo_package p
		where package_cart_package_code=photo_package_code
		and package_cart_id=#{package_cart_id}
    </select>
    <select id="clist" resultType="hashmap">
		select cos.*, c.*, cos.costume_cart_quantity*c.lend_costume_price totprice
		from costume_cart cos, lend_costume c
		where costume_cart_costume_code=lend_costume_code
		and costume_cart_id=#{costume_cart_id}
    </select>
    <!-- 장바구니 삭제 -->
    <delete id="pdelete">
    	delete from package_cart where package_cart_no=#{package_cart_no}
    </delete>
    <delete id="cdelete">
    	delete from costume_cart where costume_cart_no=#{costume_cart_no}
    </delete>
    <!-- 장바구니 수량변경 -->
    <update id="pUpdate">
		update package_cart set package_cart_quantity=#{package_cart_quantity} where package_cart_no=#{package_cart_no}
    </update>
    <update id="cUpdate">
		update costume_cart set costume_cart_quantity=#{costume_cart_quantity} where costume_cart_no=#{costume_cart_no}
    </update>
    <!-- 장바구니 총액 합계 -->
    <select id="psum" resultType="int">
    	select sum(cart.package_cart_quantity*p.photo_package_price)
		from photo_package p, package_cart cart
		where photo_package_code=package_cart_package_code and package_cart_id=#{package_cart_id};
    </select>
    <select id="csum" resultType="int">
    	select sum(cart.costume_cart_quantity*c.lend_costume_price)
		from lend_costume c, costume_cart cart
		where lend_costume_code=costume_cart_costume_code and costume_cart_id=#{costume_cart_id};
    </select>
</mapper>